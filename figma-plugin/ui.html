<head>
  <style>
    body {
      font-family: sans-serif;
      font-size: 14px;
      padding: 10px;
    }
    input, button {
      width: 100%;
      padding: 8px;
      margin-bottom: 5px;
      box-sizing: border-box;
    }
    .status {
      margin-bottom: 10px;
      font-weight: bold;
    }
    .message {
      margin-top: 10px;
      padding: 8px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <div class="status" id="status">Connecting...</div>

  <h3>Create Frame</h3>
  <label for="fileKey">File Key:</label>
  <input type="text" id="fileKey" value="YOUR_FIGMA_FILE_KEY_HERE">
  <label for="frameName">Name:</label>
  <input type="text" id="frameName" value="New Frame">
  <label for="width">Width:</label>
  <input type="number" id="width" value="100">
  <label for="height">Height:</label>
  <input type="number" id="height" value="100">
  <label for="x">X:</label>
  <input type="number" id="x" value="0">
  <label for="y">Y:</label>
  <input type="number" id="y" value="0">
  <button id="createFrameButton">Create Frame</button>

  <div class="message" id="message"></div>

  <script>
    const statusDiv = document.getElementById('status');
    const messageDiv = document.getElementById('message');
    const fileKeyInput = document.getElementById('fileKey');
    const frameNameInput = document.getElementById('frameName');
    const widthInput = document.getElementById('width');
    const heightInput = document.getElementById('height');
    const xInput = document.getElementById('x');
    const yInput = document.getElementById('y');
    const createFrameButton = document.getElementById('createFrameButton');

    // Function to send messages to code.js
    function sendMessageToCode(type, data) {
      parent.postMessage({ pluginMessage: { type, data } }, '*');
    }

    // Listen for messages from code.js
    window.onmessage = (event) => {
      const { type, data } = event.data.pluginMessage;
      if (type === 'connection-status') {
        statusDiv.textContent = `Status: ${data.status}`;
        statusDiv.style.color = data.status === 'Connected' ? 'green' : 'red';
      } else if (type === 'command-result') {
        messageDiv.textContent = `Result: ${JSON.stringify(data, null, 2)}`;
        messageDiv.style.color = 'black';
      } else if (type === 'command-error') {
        messageDiv.textContent = `Error: ${data.message || JSON.stringify(data, null, 2)}`;
        messageDiv.style.color = 'red';
      } else if (type === 'command-status') {
        messageDiv.textContent = `Status: ${data.message}`;
        messageDiv.style.color = 'gray';
      }
    };

    // Handle button click
    createFrameButton.onclick = () => {
      const params = {
        fileKey: fileKeyInput.value,
        name: frameNameInput.value,
        width: parseFloat(widthInput.value),
        height: parseFloat(heightInput.value),
        x: parseFloat(xInput.value),
        y: parseFloat(yInput.value),
      };
      sendMessageToCode('create-frame', params);
      messageDiv.textContent = 'Sending command...';
      messageDiv.style.color = 'gray';
    };

    // Initial message to code.js to get connection status
    sendMessageToCode('get-connection-status');
  </script>
</body>